---
title: "han seurat"
output: html_document
---

```{r setup, include=FALSE}

setwd("~/git/tabula-muris/")

library(here)
library(Seurat)

```

If the mca object is not loaded, load it now!

```{r}

#load(here("00_data_ingest", "sanne_analysis", "wells_han_data"))

```

## Identify interesting cells per tissue


We must first define the set of interesting tissues/cells


```{r}

tissues_of_interest = c("Aorta", "Lung", "Large_Intestine", "Kidney", "Bladder", "Liver")

aortaEndo = c("Vascular endothelial cell(Neonatal-Heart)", "Endothelial cell_Eln high(Neonatal-Heart)", "Endothelial cell_Enpp2 high(Neonatal-Heart)", "Endothelial cell_Igfbp5 high(Neonatal-Heart)")
aortaEpi = c("Epithelial cell(Neonatal-Heart)")

lungEndo = c("Endothelial cell_Kdr high(Lung)", "Endothelial cell_Tmem100 high(Lung)", "Endothelial cells_Vwf high(Lung)")
lungEpi = c("Epithelial cell_Sftpc high(Fetal_Lung)", "Epithelial cell_Aldh1a2_high(Fetal_Lung)")

lintEndo = c("Enteroendocrine(Fetal_Intestine)", "Endothelial cell(Fetal_Intestine)")
lintEpi = c("Epithelium of small intestinal villi_Fabp1 high(Small-Intestine)",
"Columnar epithelium(Small-Intestine)",
"Epithelium of small intestinal villi_Fabp6 high(Small-Intestine)",
"Epithelial cell_Kcne3 high(Small-Intestine)",
"Epithelial cell_Sh2d6 high(Small-Intestine)",
"Epithelium of small intestinal villi_S100g high(Small-Intestine)",
"Epithelium of small intestinal villi_Gm23935 high(Small-Intestine)",
"Epithelium of small intestinal villi_mt-Nd1 high(Small-Intestine)")

kidneyEndo = c("Endothelial cell(Kidney)","Fenestrated endothelial cell_Plvap high(Kidney)", "Fenestrated endothelial cell_Tm4sf1 high(Kidney)" )
kidneyEpi = c("Ureteric epithelium(Kidney)", "Epithelial cell_Cryab high(Kidney)", "Glomerular epithelial cell_Aldh1a2 high(Fetal_Kidney)")

bladderEndo = c("Urothelium(Bladder)", "Vascular endothelial cell(Bladder)","Endothelial cell_Ly6c1 high(Bladder)")
bladderEpi = c("Basal epithelial cell(Bladder)", "Epithelial cell_Upk3a high(Bladder)", "Epithelial cell_Gm23935 high(Bladder)")

liverEndo = c("Endothelial cell(Liver)")
liverEpi = c("Epithelial cell(Liver)", "Epithelia cell_Spp1 high(Liver)")


#newer version

wellsAortaEndo = c("Vascular endothelial cell(Neonatal-Heart)",
"Endothelial cell_Igfbp5 high(Neonatal-Heart)",
"Endothelial cell_Eln high(Neonatal-Heart)",
"Endothelial cell_Enpp2 high(Neonatal-Heart)")
wellsLungEndo = c("Endothelial cell_Kdr high(Lung)",
"Endothelial cell_Tmem100 high(Lung)",
"Endothelial cells_Vwf high(Lung)")
wellsLintEndo = c()
wellsKidneyEndo = c("Endothelial cell(Kidney)",
"Fenestrated endothelial cell_Plvap high(Kidney)",
"Fenestrated endothelial cell_Tm4sf1 high(Kidney)")
wellsBladderEndo = c("Vascular endothelial cell(Bladder)",
"Endothelial cell_Ly6c1 high(Bladder)")
wellsLiverEndo = c("Endothelial cell(Liver)")

wellsAortaEpi = c("Epithelial cell(Neonatal-Heart)")
wellsLungEpi = c()
wellsLintEpi = c("Columnar epithelium(Small-Intestine)",
"Epithelial cell_Kcne3 high(Small-Intestine)",
"Epithelial cell_Sh2d6 high(Small-Intestine)")
wellsKidneyEpi = c("Epithelial cell_Cryab high(Kidney)")
wellsBladderEpi = c("Basal epithelial cell(Bladder)",
"Epithelial cell_Upk3a high(Bladder)",
"Epithelial cell_Gm23935 high(Bladder)")
wellsLiverEpi = c("Epithelial cell(Liver)",
"Epithelia cell_Spp1 high(Liver)")

wellsAortaCir = c("Neutrophil_Ngp high(Neonatal-Heart)",
"Neutrophil_Retnlg high(Neonatal-Heart)")
wellsLungCir = c("B Cell(Lung)",
"NK Cell(Lung)",
"Dividing T cells(Lung)",
"Eosinophil granulocyte(Lung)",
"Neutrophil granulocyte(Lung)",
"T Cell_Cd8b1 high(Lung)",
"Basophil(Lung)")

wellsLintCir = c("T cell(Fetal_Intestine)",
"B cell_Igkv12-46 high(Small-Intestine)",
"B cell_Ms4a1 high(Small-Intestine)",
"T cell_Icos high(Small-Intestine)",
"B cell_Jchain high(Small-Intestine)",
"T cell_Cd7 high(Small-Intestine)",
"T cell_Ccl5 high(Small-Intestine)",
"T cell_Ms4a4b high(Small-Intestine)",
"B cell_Ighd high(Small-Intestine)",
"Erythroblast(Small-Intestine)")
wellsKidneyCir = c("B cell(Kidney)",
"T cell(Kidney)",
"Neutrophil progenitor_S100a8 high(Kidney)")
wellsBladderCir = c("NK cell(Bladder)")
wellsLiverCir = c("B cell_Jchain high(Liver)",
"Granulocyte(Liver)",
"T cell_Trbc2 high(Liver)",
"Erythroblast_Hbb-bt high(Liver)",
"T cell_Gzma high(Liver)",
"Erythroblast_Hbb-bs high(Liver)",
"B cell_Fcmr high(Liver)",
"Neutrophil_Ngp high(Liver)")


wellsAortaCells = c(wellsAortaEndo,wellsAortaEpi, wellsAortaCir)
wellsLungCells = c(wellsLungEndo,wellsLungEpi, wellsLungCir)
wellsLintCells = c(wellsLintEndo,wellsLintEpi, wellsLintCir)
wellsKidneyCells = c(wellsKidneyEndo,wellsKidneyEpi, wellsKidneyCir)
wellsBladderCells = c(wellsBladderEndo,wellsBladderEpi, wellsBladderCir)
wellsLiverCells = c(wellsLiverEndo,wellsLiverEpi, wellsLiverCir)


wellsAllAorta = unique(grep(pattern="Neonatal-Heart", x=mca@meta.data$Annotation, value = TRUE))
wellsAllAorta = setdiff(wellsAllAorta, wellsAortaCells)

wellsAllLung = unique(grep(pattern="(Lung)", fixed=TRUE, x=mca@meta.data$Annotation, value = TRUE))
wellsAllLung = setdiff(wellsAllLung, wellsLungCells)

wellsAllLint = unique(grep(pattern="[Small-]Intestine", x=mca@meta.data$Annotation, value = TRUE))
wellsAllLint = setdiff(wellsAllLint, wellsLintCells)

wellsAllKidney = unique(grep(pattern="Kidney", x=mca@meta.data$Annotation, value = TRUE))
wellsAllKidney = setdiff(wellsAllKidney, wellsKidneyCells)

wellsAllBladder = unique(grep(pattern="Bladder", x=mca@meta.data$Annotation, value = TRUE))
wellsAllBladder = setdiff(wellsAllBladder, wellsBladderCells)

wellsAllLiver = unique(grep(pattern="Liver", x=mca@meta.data$Annotation, value = TRUE))
wellsAllLiver = setdiff(wellsAllLiver, wellsLiverCells)


```


```{r}


print(wellsAortaCells)
print(wellsLungCells)
print(wellsLintCells)
print(wellsKidneyCells)
print(wellsBladderCells)
print(wellsLiverCells)

print(wellsAllAorta)
print(wellsAllLung)
print(wellsAllLint)
print(wellsAllKidney)
print(wellsAllBladder)
print(wellsAllLiver)



```

Define the analysis
```{r}

makeAnalysis <- function( tissues1, tissues2)
{
    newMarkers = FindMarkers(mca, ident.1=tissues1, ident.2=tissues2,only.pos=TRUE, test.use="MAST")
    return(newMarkers)
}

```

Prepare the analysis

```{r}
setCellIdent <- function (object, idp1) 
{
	
	cells.use <- rownames(x = object@meta.data)
	ident.use <- object@meta.data[, idp1]
	Idents(object = object, cells.use = cells.use)= ident.use
	
	return(object)
}


mca <- setCellIdent(object = mca, "Annotation")

```

Now we can run the analysis against each other ...

# Analysis: Endothelial Cells against each other


## Aorta vs Lung

```{r}

aorta_lung_markers_wells = makeAnalysis(aortaEndo, lungEndo)

write.table(aorta_lung_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", "aorta_lung_markers_wells.tsv") ,quote=FALSE, sep='\t')
```

## Aorta vs Lint

```{r}

aorta_lint_markers_wells = makeAnalysis(aortaEndo, lintEndo)

write.table(aorta_lint_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", "aorta_lint_markers_wells.tsv") ,quote=FALSE, sep='\t')
```

## Aorta vs Kidney
```{r}

aorta_kidney_markers_wells = makeAnalysis(aortaEndo, kidneyEndo)

write.table(aorta_kidney_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("aorta_kidney_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```

## Aorta vs Bladder

```{r}

aorta_bladder_markers_wells = makeAnalysis(aortaEndo, bladderEndo)

write.table(aorta_bladder_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("aorta_bladder_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```

## Aorta vs Liver

```{r}

aorta_liver_markers_wells = makeAnalysis(aortaEndo, liverEndo)

write.table(aorta_liver_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("aorta_liver_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```
## Lung vs Lint

```{r}

lung_lint_markers_wells = makeAnalysis(lungEndo, lintEndo)

write.table(lung_lint_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("lung_lint_markers_wells",".tsv", sep="")) ,quote=FALSE, sep='\t')
```

## Lung vs Kidney
```{r}

lung_kidney_markers_wells = makeAnalysis(lungEndo, kidneyEndo)

write.table(lung_kidney_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("lung_kidney_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```

## Lung vs Bladder

```{r}

lung_bladder_markers_wells = makeAnalysis(lungEndo, bladderEndo)

write.table(lung_bladder_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("lung_bladder_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```

## Lung vs Liver

```{r}

lung_liver_markers_wells = makeAnalysis(lungEndo, liverEndo)

write.table(lung_liver_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("lung_liver_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```



## Lint vs Kidney

```{r}

lint_kidney_markers_wells = makeAnalysis(lintEndo, kidneyEndo)

write.table(lint_kidney_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("lint_kidney_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```

## Lint vs Bladder

```{r}

lint_bladder_markers_wells = makeAnalysis(lintEndo, bladderEndo)

write.table(lint_bladder_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("lint_bladder_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```

## Lint vs Liver
```{r}

lint_liver_markers_wells = makeAnalysis(lintEndo, liverEndo)

write.table(lint_liver_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("lint_liver_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```

## Kidney vs Bladder
```{r}

kidney_bladder_markers_wells = makeAnalysis(kidneyEndo, bladderEndo)

write.table(kidney_bladder_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("kidney_bladder_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```

## Kidney vs Liver

```{r}

kidney_liver_markers_wells = makeAnalysis(kidneyEndo, liverEndo)

write.table(kidney_liver_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("kidney_liver_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```

## Bladder vs Liver
```{r}

bladder_liver_markers_wells = makeAnalysis(bladderEndo, liverEndo)

write.table(bladder_liver_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("bladder_liver_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')
```

# Analysis same organ, endo vs epi

## Aorta Endo vs Aorta Epi
```{r}

aorta_endopi_markers_wells = makeAnalysis(aortaEndo, aortaEpi)

write.table(aorta_endopi_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("aorta_endopi_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```

## Bladder Endo vs Bladder Epi
```{r}

bladder_endopi_markers_wells = makeAnalysis(bladderEndo, bladderEpi)

write.table(bladder_endopi_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("bladder_endopi_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```

## Kidney Endo vs Kidney Epi
```{r}

kidney_endopi_markers_wells = makeAnalysis(kidneyEndo, kidneyEpi)

write.table(kidney_endopi_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("kidney_endopi_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```

## Lint Endo vs Lint Epi
```{r}

lint_endopi_markers_wells = makeAnalysis(lintEndo, lintEpi)

write.table(lint_endopi_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("lint_endopi_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```

## Liver Endo vs Liver Epi
```{r}

liver_endopi_markers_wells = makeAnalysis(liverEndo, liverEpi)

write.table(liver_endopi_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("liver_endopi_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```

## Lung Endo vs Lung Epi
```{r}

lung_endopi_markers_wells = makeAnalysis(lungEndo, lungEpi)

write.table(lung_endopi_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("lung_endopi_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```

# Analysis same organ, endo vs rest+epi

## Aorta Endo

```{r}

aorta_endo_rest_markers_wells = makeAnalysis(aortaEndo, unique(c(allAorta, aortaEpi)))

write.table(aorta_endo_rest_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("aorta_endo_rest_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```
## Bladder Endo

```{r}

bladder_endo_rest_markers_wells = makeAnalysis(bladderEndo, unique(c(allBladder, bladderEpi)))

write.table(bladder_endo_rest_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("bladder_endo_rest_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```

## Kidney Endo

```{r}

kidney_endo_rest_markers_wells = makeAnalysis(kidneyEndo, unique(c(allKidney, kidneyEpi)))

write.table(kidney_endo_rest_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("kidney_endo_rest_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```

## Lint Endo

```{r}

lint_endo_rest_markers_wells = makeAnalysis(lintEndo, unique(c(allLint, lintEpi)))

write.table(lint_endo_rest_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("lint_endo_rest_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```

## Liver Endo

```{r}

liver_endo_rest_markers_wells = makeAnalysis(liverEndo, unique(c(allLiver, liverEpi)))

write.table(liver_endo_rest_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("liver_endo_rest_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```

## Lung Endo

```{r}

lung_endo_rest_markers_wells = makeAnalysis(lungEndo, unique(c(allLung, lungEpi)))

write.table(lung_endo_rest_markers_wells, file = here("00_data_ingest", "sanne_analysis", "wells_analysis", paste("lung_endo_rest_markers_wells", ".tsv", sep="")) ,quote=FALSE, sep='\t')

```

# NEW ANALYSIS

```{r}

makeNewAnalysiswells = function(targetCells, sourceCells, tissueName, prefix) {
    if (is.null(targetCells)|| is.null(sourceCells))
    {
      print("makeAnalysis failed due to null tissue")
      return(NULL)
    }
  
    if (length(targetCells) == 0 || length(sourceCells) == 0)
    {
      print("makeAnalysis failed due to 0 length tissue")
      return(NULL)
    }
  
  
  allComparisons = c()
  
  for (targetCell in targetCells)
  {
    
    targetComparisons = c()
  
    for (sourceCell in sourceCells)
    {
      
      print(targetCell)
      print(sourceCell)
      
      tryCatch({
        newMarkers = FindMarkers(mca, ident.1=c(targetCell), ident.2=c(sourceCell),only.pos=FALSE, test.use="MAST")
        
        outfname = gsub(" ", "_", paste(prefix, paste(tissueName, targetCell, sourceCell, sep = "___"), ".tsv", sep=""))
        print(outfname)
      
        write.table(newMarkers, file = here("00_data_ingest", "sanne_analysis", "wells_analysis_excl", outfname) ,quote=FALSE, sep='\t')
      },
                
          error=function(e) 
            {
            
            outfname = gsub(" ", "_", paste(prefix, paste(tissueName, targetCell, sourceCell, sep = "___"), ".tsv", sep=""))
            
            print("Error in FindMarkers")
            print(outfname)
            print(e)
            
          }
      )
                
      
      
      

      
      #targetComparisons = append(targetComparisons, list(newMarkers))
      
    }

    #allComparisons = append(allComparisons, list(targetComparisons))
    
  }
  
  return(allComparisons)
}

```

## WITHIN OWN TISSUE

```{r results="hide", echo=FALSE}

a = makeNewAnalysiswells(wellsKidneyEndo, c(wellsKidneyCir, wellsKidneyEpi, wellsAllKidney), "kidney", "excl_")
a = makeNewAnalysiswells(wellsLungEndo, c(wellsLungCir, wellsLungEpi, wellsAllLung), "lung", "excl_")
a = makeNewAnalysiswells(wellsAortaEndo, c(wellsAortaCir, wellsAortaEpi, wellsAllAorta), "aorta", "excl_")
a = makeNewAnalysiswells(wellsBladderEndo, c(wellsBladderCir, wellsBladderEpi, wellsAllBladder), "bladder", "excl_")
a = makeNewAnalysiswells(wellsLiverEndo, c(wellsLiverCir, wellsLiverEpi, wellsAllLiver), "liver", "excl_")

a = makeNewAnalysiswells(wellsLintEndo, c(wellsLintCir, wellsLintEpi, wellsAllLint), "lint", "excl_")

```

## WITHIN OWN CLASS

```{r results="hide", echo=FALSE}

a=makeNewAnalysiswells(wellsKidneyEndo, c(wellsLungEndo, wellsAortaEndo, wellsBladderEndo, wellsLiverEndo, wellsLintEndo), "kidney", "endo_excl_")
a=makeNewAnalysiswells(wellsLungEndo, c(wellsKidneyEndo, wellsAortaEndo, wellsBladderEndo, wellsLiverEndo, wellsLintEndo), "lung", "endo_excl_")
a=makeNewAnalysiswells(wellsAortaEndo, c(wellsLungEndo, wellsKidneyEndo, wellsBladderEndo, wellsLiverEndo, wellsLintEndo), "aorta", "endo_excl_")
a=makeNewAnalysiswells(wellsBladderEndo, c(wellsAortaEndo, wellsLungEndo, wellsKidneyEndo, wellsLiverEndo, wellsLintEndo), "bladder", "endo_excl_")
a=makeNewAnalysiswells(wellsLiverEndo, c(wellsAortaEndo, wellsLungEndo, wellsKidneyEndo, wellsBladderEndo, wellsLintEndo), "liver", "endo_excl_")

a=makeNewAnalysiswells(wellsLintEndo, c(wellsAortaEndo, wellsLungEndo, wellsKidneyEndo, wellsBladderEndo, wellsLiverEndo), "lint", "endo_excl_")

```


## AGAINST ALL OTHER BLOOD CIRCULATING STUFF

```{r results="hide", echo=FALSE}
a=makeNewAnalysiswells(wellsKidneyEndo, c(wellsKidneyCir, wellsLungCir, wellsAortaCir, wellsBladderCir, wellsLiverCir), "kidney", "endo_cir_excl_")
a=makeNewAnalysiswells(wellsLungEndo, c(wellsLungCir, wellsKidneyCir, wellsAortaCir, wellsBladderCir, wellsLiverCir), "lung", "endo_cir_excl_")
a=makeNewAnalysiswells(wellsAortaEndo, c(wellsAortaCir, wellsLungCir, wellsKidneyCir, wellsBladderCir, wellsLiverCir), "aorta", "endo_cir_excl_")
a=makeNewAnalysiswells(wellsBladderEndo, c(wellsBladderCir, wellsAortaCir, wellsLungCir, wellsKidneyCir, wellsLiverCir), "bladder", "endo_cir_excl_")
a=makeNewAnalysiswells(wellsLiverEndo, c(wellsLiverCir, wellsAortaCir, wellsLungCir, wellsKidneyCir, wellsBladderCir), "liver", "endo_cir_excl_")

a=makeNewAnalysiswells(wellsLintEndo, c(wellsLiverCir, wellsAortaCir, wellsLungCir, wellsKidneyCir, wellsBladderCir, wellsLintCir), "lint", "endo_cir_excl_")
```

## AGAINST ALL OTHER EPITHELIAL

```{r results="hide", echo=FALSE}
a=makeNewAnalysiswells(wellsKidneyEndo, c(wellsKidneyEpi, wellsLungEpi, wellsAortaEpi, wellsBladderEpi, wellsLiverEpi), "kidney", "endo_epi_excl_")
a=makeNewAnalysiswells(wellsLungEndo, c(wellsLungEpi, wellsKidneyEpi, wellsAortaEpi, wellsBladderEpi, wellsLiverEpi), "lung", "endo_epi_excl_")
a=makeNewAnalysiswells(wellsAortaEndo, c(wellsAortaEpi, wellsLungEpi, wellsKidneyEpi, wellsBladderEpi, wellsLiverEpi), "aorta", "endo_epi_excl_")
a=makeNewAnalysiswells(wellsBladderEndo, c(wellsBladderEpi, wellsAortaEpi, wellsLungEpi, wellsKidneyEpi, wellsLiverEpi), "bladder", "endo_epi_excl_")
a=makeNewAnalysiswells(wellsLiverEndo, c(wellsLiverEpi, wellsAortaEpi, wellsLungEpi, wellsKidneyEpi, wellsBladderEpi), "liver", "endo_epi_excl_")
```



## AGAINST ALL 

```{r results="hide", echo=FALSE, message=F, warning=F}
a=makeNewAnalysiswells(wellsKidneyEndo, c(wellsKidneyEpi, wellsLungEpi, wellsAortaEpi, wellsBladderEpi, wellsLiverEpi,wellsKidneyCir, wellsLungCir, wellsAortaCir, wellsBladderCir, wellsLiverCir), "kidney", "endo_cirepi_excl_")
a=makeNewAnalysiswells(wellsLungEndo, c(wellsKidneyEpi, wellsLungEpi, wellsAortaEpi, wellsBladderEpi, wellsLiverEpi,wellsLungCir, wellsKidneyCir, wellsAortaCir, wellsBladderCir, wellsLiverCir), "lung", "endo_cirepi_excl_")
a=makeNewAnalysiswells(wellsAortaEndo, c(wellsKidneyEpi, wellsLungEpi, wellsAortaEpi, wellsBladderEpi, wellsLiverEpi,wellsAortaCir, wellsLungCir, wellsKidneyCir, wellsBladderCir, wellsLiverCir), "aorta", "endo_cirepi_excl_")
a=makeNewAnalysiswells(wellsBladderEndo, c(wellsKidneyEpi, wellsLungEpi, wellsAortaEpi, wellsBladderEpi, wellsLiverEpi,wellsBladderCir, wellsAortaCir, wellsLungCir, wellsKidneyCir, wellsLiverCir), "bladder", "endo_cirepi_excl_")
a=makeNewAnalysiswells(wellsLiverEndo, c(wellsKidneyEpi, wellsLungEpi, wellsAortaEpi, wellsBladderEpi, wellsLiverEpi,wellsLiverCir, wellsAortaCir, wellsLungCir, wellsKidneyCir, wellsBladderCir), "liver", "endo_cirepi_excl_")
```